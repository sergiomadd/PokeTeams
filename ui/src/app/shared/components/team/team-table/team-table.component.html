<div
  class="team-table flex-col align-i-c w-80"
  #results
  [ngClass]="{searching: searched}"
  >
  <div class="bar w-100 pad-m flex justify-c-sb">
    <div class="flex justify-c-c gap-m">
      @for (item of sortTypeIds; track item; let i = $index) {
        <div class="flex pad-0 gap-s bor-1-3 bor-rad-10 pointer no-select" (click)="changeSorter(i)">
          <div class="sorter-text">
            {{'search.team_table.sort_' + item | translate}}
          </div>
          <div class="way flex justify-c-s relative w-100">
            @if (sortOrder.type != i) {
              <div class="col">
                <svg class="icon absolute up-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M1658 2652 c-475 -488 -880 -906 -900 -930 -43 -48 -47 -77 -17 -116 l20 -26 1799 0 1799 0 20 26 c30 39 26 67 -18 118 -22 25 -427 444 -901 931 -848 871 -862 885 -900 885 -38 0 -52 -14 -902 -888z"/> </g> </svg>
                <svg class="icon absolute down-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M783 3543 c-29 -6 -63 -49 -63 -79 0 -15 20 -46 52 -81 29 -32 434 -451 901 -930 834 -858 849 -873 887 -873 38 0 53 15 887 873 467 479 872 898 901 930 59 65 64 91 28 134 l-24 28 -1774 1 c-975 1 -1783 -1 -1795 -3z"/> </g> </svg>
              </div>
            }
            @if (sortOrder.type == i && sortOrder.way === 1) {
              <div class="col">
                <svg class="icon absolute up-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M1658 2652 c-475 -488 -880 -906 -900 -930 -43 -48 -47 -77 -17 -116 l20 -26 1799 0 1799 0 20 26 c30 39 26 67 -18 118 -22 25 -427 444 -901 931 -848 871 -862 885 -900 885 -38 0 -52 -14 -902 -888z"/> </g> </svg>
                <svg class="icon absolute down-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M783 3543 c-29 -6 -63 -49 -63 -79 0 -15 20 -46 52 -81 29 -32 434 -451 901 -930 834 -858 849 -873 887 -873 38 0 53 15 887 873 467 479 872 898 901 930 59 65 64 91 28 134 l-24 28 -1774 1 c-975 1 -1783 -1 -1795 -3z m3335 -164 c-4 -12 -1550 -1607 -1558 -1607 -8 0 -1554 1595 -1558 1607 -3 8 448 11 1558 11 1095 0 1561 -3 1558 -11z"/> </g> </svg>
              </div>
            }
            @if (sortOrder.type == i && sortOrder.way === 0) {
              <div class="col">
                <svg class="icon absolute up-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M1658 2652 c-475 -488 -880 -906 -900 -930 -43 -48 -47 -77 -17 -116 l20 -26 1799 0 1799 0 20 26 c30 39 26 67 -18 118 -22 25 -427 444 -901 931 -848 871 -862 885 -900 885 -38 0 -52 -14 -902 -888z m1686 -107 l777 -800 -780 -3 c-430 -1 -1132 -1 -1562 0 l-780 3 778 802 c428 441 780 801 784 800 3 -1 355 -362 783 -802z"/> </g> </svg>
                <svg class="icon absolute down-arrow" version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none"> <path d="M783 3543 c-29 -6 -63 -49 -63 -79 0 -15 20 -46 52 -81 29 -32 434 -451 901 -930 834 -858 849 -873 887 -873 38 0 53 15 887 873 467 479 872 898 901 930 59 65 64 91 28 134 l-24 28 -1774 1 c-975 1 -1783 -1 -1795 -3z"/> </g> </svg>
              </div>
            }
          </div>
        </div>
      }
    </div>
    <div class="flex justify-c-c gap-m">
      <div class="flex pad-m gap-m bor-1-3 bor-rad-10">{{totalTeams ?? '?'}} {{totalTeams == 1 ? ('search.team_table.total_teams_single' | translate) : ('search.team_table.total_teams' | translate)}}</div>
    </div>
  </div>
  <div class="relative flex-col align-i-c gap-l m-auto w-100">
    <div class="w-100 flex wrap justify-c-c align-i-s gap-l"  style="min-height: 60vh;">
      @if (searched) {
        <div class="loader-wrapper">
          <div class="pokemon-spinner"></div>
        </div>
      }
      @if (teams && teams.length > 0) {
        @for (team of teams; track team) {
          <div class="w-100 record">
            <app-team-preview
              [team]="team"
              [logged]="logged"
              (deleteEvent)="deleteTeam()"
            ></app-team-preview>
          </div>
        }
      } @else {
        <div class="flex align-i-c w-fit b-2 text-c bor-rad-5 pad-l"
          style="border: 1px solid var(--bg-color-3); margin-top: 2em;">
          {{'search.team_table.no_teams' | translate}}
        </div>
      }
    </div>
    <div class="pagination">
      <div></div>
      <app-pagination
        [itemsPerPage]="paginationForm.controls.teamsPerPage.valid ? paginationForm.controls.teamsPerPage.value ?? defaultTeams : defaultTeams"
        [totalItems]="totalTeams ?? 0"
        (pageChanged)="pageChange($event, results)"
      ></app-pagination>
      @if (window.currentDevice === window.DeviceType.desktop) {
        <form class="flex-col align-i-c gap-s" [formGroup]="paginationForm">
          <div class="flex justify-c-c gap-s">
            <label for="">{{'search.team_table.teams_per_page' | translate}}</label>
            <input
              type="text"
              class="teams-per-page"
              formControlName="teamsPerPage"
              [ngClass]="{controlInvalid: isInvalid('teamsPerPage')}"
              >
            </div>
            @if (isInvalid('teamsPerPage')) {
              <span class="formFeedbackError text-center">{{getError('teamsPerPage')}}</span>
            }
          </form>
        }
      </div>
    </div>
    @if (teamsToCompare && teamsToCompare.length > 0) {
      <div class="to-compare">
        <div class="relative w-100 flex justify-c-c align-i-c pointer" (click)="toggleTeamsToCompare()">
          <span class="no-select">{{'team.compare.popup_title' | translate:{ teamsToCompare: teamsToCompare.length/2 }</span>
          <button type="button"
            class="no-shadow button to-compare-toggle icon-m pad-s"
            [ngClass]="{'to-compare-toggle-rotate': !teamsToCompareOpen}"
            >
            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
              <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="var(--text-color)" stroke="none">
                <path d="M1658 2652 c-475 -488 -880 -906 -900 -930 -43 -48 -47 -77 -17 -116 l20 -26 1799 0 1799 0 20 26 c30 39 26 67 -18 118 -22 25 -427 444 -901 931 -848 871 -862 885 -900 885 -38 0 -52 -14 -902 -888z"/>
              </g>
            </svg>
          </button>
        </div>
        <div class="flex flex-col justify-c-c align-i-c gap-l to-compare-content"
          [ngClass]="{'to-compare-content-closed': !teamsToCompareOpen}"
          >
          <div class="flex flex-col justify-c-c align-i-c gap-l" style="margin-top: 0.8em;">
            @for (team of teamsToCompare; track team; let i = $index) {
              <div class="w-100 bor-1-3"></div>
              <div class="flex justify-c-c align-i-c gap-l">
                <div class="pad-s bor-rad-20 icon text-center flex justify-c-c align-i-c" style="font-size: 1.3em; color: var(--white);"
                  [ngStyle]="{'background-color': i === 0 ? 'var(--blue-team)' : 'var(--red-team)'}"
                >{{i === 0 ? 'A' : 'B'}}</div>
                <app-pokemon-icons [pokemons]="team.pokemonPreviews"></app-pokemon-icons>
                <button (click)="removeTeamToCompare(i)" class="close icon-button icon-m">
                  <svg viewBox="0 0 24 24" fill="" xmlns="http://www.w3.org/2000/svg">
                    <path fill="var(--error)" d="M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z"/>
                    <path fill="var(--white)" d="M8.96967 8.96967C9.26256 8.67678 9.73744 8.67678 10.0303 8.96967L12 10.9394L13.9697 8.96969C14.2626 8.6768 14.7374 8.6768 15.0303 8.96969C15.3232 9.26258 15.3232 9.73746 15.0303 10.0304L13.0607 12L15.0303 13.9696C15.3232 14.2625 15.3232 14.7374 15.0303 15.0303C14.7374 15.3232 14.2625 15.3232 13.9696 15.0303L12 13.0607L10.0304 15.0303C9.73746 15.3232 9.26258 15.3232 8.96969 15.0303C8.6768 14.7374 8.6768 14.2626 8.96969 13.9697L10.9394 12L8.96967 10.0303C8.67678 9.73744 8.67678 9.26256 8.96967 8.96967Z"/>
                  </svg>
                </button>
              </div>
            }
          </div>
          <div class="w-100 bor-1-3"></div>
          <div class="relative w-100 flex align-i-c justify-c-c">
            <button class="button button-primary" style="font-size: 0.9em;" (click)="compare()">{{'team.compare.popup_button' | translate}}</button>
            @if (teamsToCompare.length === 2) {
              <button class="swap-button button icon-l pad-s" (click)="swapTeamsToCompare()">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M8 3.5L8 16.5M8 3.5L3.5 7.83333M8 3.5L12.5 7.83333" stroke="var(--text-color)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M17 20.5L17 7.5M17 20.5L21.5 16.1667M17 20.5L12.5 16.1667" stroke="var(--text-color)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
            }
          </div>
          @if (teamsToCompareFeedback) {
            <span class="formFeedbackError">{{teamsToCompareFeedback}}</span>
          }
        </div>
      </div>
    }
  </div>